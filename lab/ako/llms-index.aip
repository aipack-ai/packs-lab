# Data

```lua
local p_utils = require("prompt_utils")

-- If return a string, means not valid, and it's the message
local valid = p_utils.validate_aip_version()
if type(valid) == "string" then
  return aip.flow.skip(valid)
end


-- input is nil or the config_path
local init_res = p_utils.init_config(input)

if init_res.type == "message" then
  print(init_res.data)
  return
end

-- Assuming type = "config"
local config = init_res.data

local settings = p_utils.build_settings(config)

local globs = {
  settings.dir_3_sum_md .. "/**/*.md",
}

local files = aip.file.list_load(globs)

-- Normalize paths to be relative to the content root (dir_3_sum_md)
local root_dir = settings.dir_3_sum_md
for i, file in ipairs(files) do
    file.rel_path = aip.path.diff(file.path, root_dir)
end

local msg =    "Processing llms.md for ➜ " .. #files .. " files"
aip.run.pin("status", {label = "Starting:", content = msg})

-- Load the llms instruction from instructions folder
local instruction_llms = p_utils.load_instruction(config.config_path, "instruction-2-llms-index.md")

print("Creating llms.md for " .. #files .. " files")

return aip.flow.data_response({
  options = {
    model = config.llms_model
  },
  data = {
    files            = files,
    dir_4_final_md   = settings.dir_4_final_md,
    instruction_llms = instruction_llms or ""
  }
})

```

# System

You are an agent that create `llms.md` in markdown from a list of files and their content. 

# Instruction

Here are all of the files we need to build a llms.md for. 

{{#each data.files}}
<FILE_CONTENT file_path = "{{this.rel_path}}>
````{{this.ext}}
{{this.content}}
````
</FILE_CONTENT>

{{/each}}

{{data.instruction_llms}}

# Output

```lua

if ai_response == nil then
  return "no AI Response"
end

-- remove the eventual block content
local content = aip.md.outer_block_content_or_raw(ai_response.content)

local llms_path = data.dir_4_final_md .. "/llms.md"
local llms_file = aip.file.save(llms_path, content)
local llms_size_fmt = aip.text.format_size(llms_file.size, {trim = true})
local msg =    "✅ " .. llms_path .. " processed (" .. llms_size_fmt .. ")."
aip.run.pin("status", {label = "DONE:", content = msg})

return {
  _display      = "LLM Index File (" .. llms_size_fmt .. ")" .. "\n➜ " .. llms_path,
  llms_path     = llms_path,
  llms_size     = llms_file.size
}

```

# After All

```lua

return {
  llms_path = outputs[1].llms_path,
  llms_size = outputs[1].llms_size
}

```

